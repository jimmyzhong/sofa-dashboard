<!DOCTYPE html>
<html lang="zh" xmlns:th="http://www.thymeleaf.org">
<head>
    <th:block th:include="include :: header('新增版本')"/>
</head>
<body class="white-bg">
<div class="wrapper wrapper-content animated fadeInRight ibox-content">
    <form class="form-horizontal m" id="form-shop-version-add">
        <div class="form-group">
            <label class="col-sm-3 control-label is-required">版本类型：</label>
            <div class="col-sm-8">
                <div id="type">
                    <span><input type="radio" name="type" value="Ios" checked onchange="typeChange()">Ios</span>
                    <span style="margin-left: 10px"><input type="radio" name="type" value="Android" onchange="typeChange()">Android</span>
                </div>
            </div>
        </div>
        <div class="form-group">
            <label class="col-sm-3 control-label is-required">版本号：</label>
            <div class="col-sm-8">
                <input class="form-control" type="text" name="version" id="version" required>
            </div>
        </div>
        <div class="form-group">
            <label class="col-sm-3 control-label is-required">下载链接：</label>
            <div class="col-sm-8">
				<div style="position: relative">
					<input class="form-control" type="text" name="url" id="url" required>
					<label class="input-group-btn" id="upLoad" style="display: none;position: absolute;top: 0;right: 48px">
						<a type="button" class="btn btn-primary">上传</a>
						<input onchange="uploadImg()" style="display: none" type="file" class="" id="imageFile"
							   accept="image/*"/>
					</label>
				</div>
            </div>
        </div>
        <div class="form-group">
            <label class="col-sm-3 control-label is-required">版本介绍：</label>
            <div class="col-sm-8">
                <textarea class="form-control" id="description" name="description" required></textarea>
            </div>
        </div>
        <div class="form-group">
            <label class="col-sm-3 control-label is-required">最低更新版本：</label>
            <div class="col-sm-8">
                <input class="form-control" type="text" name="forceUpdateVersion" id="forceUpdateVersion" required>
            </div>
        </div>
    </form>
</div>
<th:block th:include="include :: footer"/>
<script type="text/javascript" th:inline="javascript">
    var prefix = ctx + "ext/shop/version";

	function uploadImg(){
		var formdata = new FormData();
		formdata.append("file", $("#imageFile")[0].files[0]);
		SHOP_COMMON.ajax.uploadFile(formdata,function (result) {
			$("#url").val(result.data.fileUrl)
		})
	}

    $("#form-shop-version-add").validate({
        onkeyup: false,
        focusCleanup: true
    });
	function typeChange() {
		if($("#type input[type=radio]:checked").val()=="Android"){
			$("#upLoad").show();
		}else{
			$("#upLoad").hide();
		}
	}
    function submitHandler() {
        if ($.validate.form()) {
            var data = $("#form-shop-version-add").serializeArray();
            $.operate.save(prefix + "/add", data);
        }
    }
</script>
</body>
</html>
